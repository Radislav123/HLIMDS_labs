ФЕДЕРАЛЬНОЕ ГОСУДАРСТВЕННОЕ АВТОНОМНОЕ  
ОБРАЗОВАТЕЛЬНОЕ УЧРЕЖДЕНИЕ ВЫСШЕГО ОБРАЗОВАНИЯ  
«НАЦИОНАЛЬНЫЙ ИССЛЕДОВАТЕЛЬСКИЙ УНИВЕРСИТЕТ  
«ВЫСШАЯ ШКОЛА ЭКОНОМИКИ»

**Московский институт электроники и математики**

**им. А.Н.Тихонова НИУ ВШЭ**

**Департамент компьютерной инженерии**

Курс «Высокоуровневое и имитационное моделирование цифровых систем»

**ОТЧЕТ  
ПО ЛАБОРАТОРНОЙ РАБОТЕ №2**

Тема работы: «Проектирование аппаратной реализации нейронной сети на
ПЛИС. HDL реализация»

**Выполнили:**

Студенты группы БИВ174

Бригада №5

Подчезерцев Алексей Евгеньевич

Солодянкин Андрей Александрович

**Принял:**

асс. МИЭМ НИУ ВШЭ

Американов А.А.

Москва   г.

Задание
=======

Бригада №5, вариант 1, плата DE10-nano.

1.  Разработать на высокоуровневом языке программирования модель сети
    Хебба, способную распознать не менее 8 различных букв;

2.  Разработать модель нейрона на Verilog, произвести моделирование;

3.  Объединить нейроны, определить точность распознавания;

4.  Определить зависимость потребления ресурсов от количества нейронов;

5.  Выполнить прототипирование сети.

Выполнение работы
=================

Разработка сети
---------------

Была создана модель сети Хебба с помощью языка программирования Python.
Низким уровнем сигнала был принят 0, а высоким – 1. Кроме того, была
написана дополнительная логика для сохранения полученной модели в код на
Verilog, а так же проверки на переполнение полученной модели.

Исходный код нейрона:

Исходный код слоя:

Исходный код модели:

Исходный код верхнеуровневого модуля:

Результат запуска:

Программа отображает прогресс выполнения и может индицировать о
досрочном завершении. После отображается ожидаемое и предсказанное
значение для каждого символа и сам символ. В самом конце генерируется
фрагмент кода для тестирования устройства. Созданный код нейрона и веса
автоматически сохраняются после обучения.

Разработка сети на Verilog
--------------------------

Полученный код нейрона на языке Verilog: Для подсчета суммы
использовалась оптимизация, которая позволяет сократить длительность
подсчета суммы с линейного времени от размера изображения до логарифма
от этого значения. Кроме того, операция умножения была заменена
тернарным оператором, так как всего возможно 2 ситуации – умножение на 0
и на 1. В первом случае результат 0, в другом – то же самое число.
Результат симуляции малой версии нейрона на примере из методических
указаний представлен на
рис. <a href="#fig:sim_small" data-reference-type="ref" data-reference="fig:sim_small">1</a>.

<figure>
<img src="images/sim_small.png" id="fig:sim_small" alt="Симуляция малого нейрона" /><figcaption aria-hidden="true">Симуляция малого нейрона</figcaption>
</figure>

Объединение нейронов
--------------------

Было выполнено объединение нейронов с помощью конструкции generate.
Однако, симулятор Icarus Verilog требовал имени для каждого инстанса
нейрона, поэтому цикл был развернут вручную.

Было проведена симуляция и тестирование сети
(рис. <a href="#fig:sim_test" data-reference-type="ref" data-reference="fig:sim_test">2</a>).
По результатам тестирования предсказание сети на Python совпало с
результатом симуляции Verilog, то есть сеть идеально распознавала
элементы. Такое высокое качество было достигнуто за счёт подбора хорошей
разметки. Стандартные варианты разметки не давали приличного качества
даже на высокоуровневых языках. Это связано с несовершенствами сети
Хебба.

<figure>
<img src="images/sim_test.png" id="fig:sim_test" alt="Симуляция слоя сети" /><figcaption aria-hidden="true">Симуляция слоя сети</figcaption>
</figure>

Потребление ресурсов
--------------------

Итоговая схема потребляет 1 логический элемент. На каждый пиксель
изображения и на каждый выход сети расходуется по 1 пину. На сеть с 100
выходов тратится 120 пинов и 1 логический элемент
(рис. <a href="#fig:plot" data-reference-type="ref" data-reference="fig:plot">3</a>).

<figure>
<img src="images/plot.png" id="fig:plot" alt="Потребление ресурсов" /><figcaption aria-hidden="true">Потребление ресурсов</figcaption>
</figure>

Исходные коды
=============

Исходные коды доступны на
<https://github.com/AsciiShell/hse_hlimds_labs>.

Pull request работы
<https://github.com/AsciiShell/hse_hlimds_labs/pull/2>.

Релизы <https://github.com/AsciiShell/hse_hlimds_labs/releases>.

Выводы по работе
================

В ходе работы была изучена сеть Хебба, разобран принцип ее работы,
особенности обучения сети. Были подобраны изображения и разметка,
позволяющая идеально точно выполнять работу сети. Была создана
программа, позволяющая перенести обученную сеть на Verilog. Проведено
тестирование сети, получены результаты точности распознавания,
потребления ресурсов. Итоговый вариант был записан на плату.
